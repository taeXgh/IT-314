-- problem 1
-- a) where clause
SELECT TITLE, NAME, PHONE
FROM BOOKS b, PUBLISHER p
WHERE b.PUBID = p.PUBID;

-- b) join clause
SELECT TITLE, NAME, PHONE
FROM BOOKS JOIN PUBLISHER USING (PUBID);

-- problem 2
-- a) where clause
SELECT FIRSTNAME, LASTNAME, SHIPDATE
FROM CUSTOMERS c, ORDERS o
WHERE c.CUSTOMER# = o.CUSTOMER#
AND o.SHIPDATE IS NULL
ORDER BY o.ORDERDATE;
-- b) join clause
SELECT FIRSTNAME, LASTNAME, SHIPDATE
FROM CUSTOMERS JOIN ORDERS USING (CUSTOMER#)
WHERE SHIPDATE IS NULL
ORDER BY ORDERDATE;

-- problem 3
-- a) where clause
SELECT FIRSTNAME, LASTNAME, STATE
FROM CUSTOMERS c, ORDERS o, ORDERITEMS oi, BOOKS b
WHERE c.CUSTOMER# = o.CUSTOMER#
AND o.ORDER# = oi.ORDER#
AND oi.ISBN = b.ISBN
AND b.CATEGORY = 'COMPUTER'
AND c.STATE = 'FL';
-- b) join clause
SELECT FIRSTNAME, LASTNAME, STATE
FROM CUSTOMERS JOIN ORDERS USING (CUSTOMER#)
JOIN ORDERITEMS USING (ORDER#)
JOIN BOOKS USING (ISBN)
WHERE CATEGORY = 'COMPUTER'
AND STATE = 'FL';

-- problem 4
-- a) where clause
SELECT DISTINCT TITLE, FIRSTNAME, LASTNAME
FROM CUSTOMERS c, ORDERS o, ORDERITEMS oi, BOOKS b
WHERE c.CUSTOMER# = o.CUSTOMER#
AND o.ORDER# = oi.ORDER#
AND oi.ISBN = b.ISBN
AND FIRSTNAME LIKE 'JAK_' AND LASTNAME LIKE 'LUCA_';
-- b) join clause
SELECT DISTINCT TITLE, FIRSTNAME, LASTNAME
from CUSTOMERS JOIN ORDERS USING (CUSTOMER#)
JOIN ORDERITEMS USING (ORDER#)
JOIN BOOKS USING (ISBN)
WHERE FIRSTNAME LIKE 'JAK_' AND LASTNAME LIKE 'LUCA_';

-- problem 5
-- a) where clause
SELECT FIRSTNAME || ' ' || LASTNAME AS CUSTOMER_NAME, PAIDEACH
FROM CUSTOMERS, ORDERS, ORDERITEMS, BOOKS
WHERE CUSTOMERS.CUSTOMER# = ORDERS.CUSTOMER#
AND ORDERS.ORDER# = ORDERITEMS.ORDER#
AND ORDERITEMS.ISBN = BOOKS.ISBN
AND CUSTOMER_NAME LIKE 'JAKE%'
ORDER BY ORDERDATE, PAIDEACH DESC;


